<ion-header [translucent]="true">
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-button slot="start" routerLink="['/tabs/home']">
        Atrás
        <ion-icon slot="start" name="arrow-back"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>Inspección No. {{currentInspection()?.idInspeccion}}</ion-title>
    <!-- <ion-buttons slot="end">
      <ion-button slot="end" (click)="goToNext()">
        Siguiente
        <ion-icon slot="end" name="arrow-forward"></ion-icon>
      </ion-button>
    </ion-buttons> -->
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-card style="border-radius: 10px">
    <ion-card-header>
      <ion-card-subtitle>
        Cliente: {{currentInspection()?.contract?.customer?.nomCliente}}
      </ion-card-subtitle>
      <ion-card-title
        >Contrato No: {{currentInspection()?.contract?.numContrato}} | Estado:
        {{currentInspection()?.state?.descEstado}}</ion-card-title
      >
    </ion-card-header>
    <ion-card-content>
      <ion-grid fixed>
        <ion-row class="ion-justify-content-start">
          <ion-col size="6">
            <ion-label
              >No. Vehículo: {{currentInspection()?.car?.nemVehiculo}}
            </ion-label>
          </ion-col>
          <ion-col size="6">
            <ion-label
              >Marca y modelo:
              {{currentInspection()?.car?.model?.brand?.descMarca}}
              {{currentInspection()?.car?.modelo}}</ion-label
            >
          </ion-col>
        </ion-row>
      </ion-grid>
    </ion-card-content>
  </ion-card>
  <ion-card>
    <ion-card-content>
      <ion-card-title>Checkout</ion-card-title>
      <ion-grid fixed>
        <ion-row>
          <ion-col size="12">
            <strong>Datos generales</strong>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col size="6"
            >Agencia:
            {{currentInspection()?.contract?.check_out_agency?.descAgencia}}
          </ion-col>
          <ion-col size="6">
            Kilometraje: {{currentInspection()?.odoSalida | number:'0.0'}}
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col size="6">
            Nivel de combustible: {{currentInspection()?.combSalida}}
          </ion-col>
          <ion-col size="6">
            Agente: {{currentInspection()?.checkout_agent?.nomUsuario}}
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col size="12">
            <ion-label>Licencia:</ion-label>
            @if (currentInspection()?.fotoLicencia != null) {

            <ion-img
              [src]="photosDirectory + currentInspection()?.fotoLicencia"
            ></ion-img>
            }@else {
            <p>Sin registro</p>
            }
          </ion-col>
        </ion-row>

        <ion-row>
          <ion-col size="12">
            <strong>Daños</strong>
          </ion-col>
        </ion-row>
        @for (damage of currentInspection()?.checkout_damages; track $index) {
        <ion-card>
          <img [src]="photosDirectory + damage.fotos" alt="foto de daño" />
          <ion-card-header>
            <ion-card-title
              >Tipo de daño:
              {{damage.damage_type?.descTipoDanio}}</ion-card-title
            >
            <ion-card-subtitle
              >Pieza: {{damage.damage_part?.descPieza}}</ion-card-subtitle
            >
          </ion-card-header>
        </ion-card>

        }@empty {
        <ion-row>
          <ion-col size="12">Sin registro</ion-col>
        </ion-row>
        }

        <ion-row>
          <ion-col size="12">
            <strong>Accesorios</strong>
          </ion-col>
        </ion-row>
        <ion-grid fixed>
          <ion-list class="ion-justify-content-start">
            @for (accessory of currentInspection()?.checkout_accessories; track
            $index) {

            <ion-item>
              <ion-checkbox color="secondary" disabled="true" checked="true"
                >{{accessory.nomAccesorio}}
              </ion-checkbox>
            </ion-item>

            }@empty {
            <ion-item lines="none">
              <ion-icon slot="start" name="alert-circle"></ion-icon>
              <ion-label>Sin registro</ion-label>
            </ion-item>
            }
          </ion-list>
        </ion-grid>

        <ion-row>
          <ion-col size="12">
            <strong>Firma del cliente</strong>
          </ion-col>
          <ion-col size="12">
            <img
              [src]="photosDirectory + currentInspection()?.firmaClienteSalida"
              alt="firma del cliente"
            />
          </ion-col>
        </ion-row>
      </ion-grid>

      @if (currentInspection()?.idEstado == 49) {
      <ion-card-title>Checkin</ion-card-title>
      <ion-grid fixed>
        <ion-row>
          <ion-col size="12">
            <strong>Datos generales</strong>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col size="6"
            >Agencia:
            {{currentInspection()?.contract?.check_in_agency?.descAgencia}}
          </ion-col>
          <ion-col size="6">
            Kilometraje: {{currentInspection()?.odoEntrega | number:'0.0'}}
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col size="6">
            Nivel de combustible: {{currentInspection()?.combEntrega}}
          </ion-col>
          <ion-col size="6">
            Agente: {{currentInspection()?.checkin_agent?.nomUsuario}}
          </ion-col>
        </ion-row>

        <ion-row>
          <ion-col size="12">
            <strong>Daños</strong>
          </ion-col>
        </ion-row>
        @for (damage of currentInspection()?.checkin_damages; track $index) {
        <ion-card>
          <img [src]="photosDirectory + damage.fotos" alt="foto de daño" />
          <ion-card-header>
            <ion-card-title
              >Tipo de daño:
              {{damage.damage_type?.descTipoDanio}}</ion-card-title
            >
            <ion-card-subtitle
              >Pieza: {{damage.damage_part?.descPieza}}</ion-card-subtitle
            >
          </ion-card-header>
        </ion-card>

        }@empty {
        <ion-row>
          <ion-col size="12">Sin registro</ion-col>
        </ion-row>
        }

        <ion-row>
          <ion-col size="12">
            <strong>Accesorios</strong>
          </ion-col>
        </ion-row>
        <ion-grid fixed>
          <ion-list class="ion-justify-content-start">
            @for (accessory of currentInspection()?.checkin_accessories; track
            $index) {

            <ion-item>
              <ion-checkbox color="secondary" disabled="true" checked="true"
                >{{accessory.nomAccesorio}}
              </ion-checkbox>
            </ion-item>

            }@empty {
            <ion-item lines="none">
              <ion-icon slot="start" name="alert-circle"></ion-icon>
              <ion-label>Sin registro</ion-label>
            </ion-item>
            }
          </ion-list>
        </ion-grid>

        <ion-row>
          <ion-col size="12">
            <strong>Firma del cliente</strong>
          </ion-col>
          <ion-col size="12">
            <img
              [src]="photosDirectory + currentInspection()?.firmaClienteEntrega"
              alt="firma del cliente"
            />
          </ion-col>
        </ion-row>
      </ion-grid>
      }
    </ion-card-content>
  </ion-card>
</ion-content>
