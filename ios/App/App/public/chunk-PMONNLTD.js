import{a as ze,b as $e}from"./chunk-HUIOHKJA.js";import{a as O}from"./chunk-WTY6MB72.js";import{b as je,c as E}from"./chunk-LEX6B2L3.js";import{a as Ee,b as Ce,c as we,d as De,e as Pe,f as ke,g as Fe,i as Te,k as Ae,m as Be,p as Oe,q as Re,r as Le,s as Me,t as Ne,u as He,v as Ue}from"./chunk-7JYYFWPO.js";import{d as xe}from"./chunk-3Z42Z5P2.js";import{a as ye}from"./chunk-HCFXBRVH.js";import{$ as H,$a as X,A as S,Cb as de,Db as ue,E as c,Ea as G,Eb as fe,G as b,Ga as W,Gb as he,H as C,Ha as q,I as w,J as D,K as e,Ka as K,L as o,M as s,P as B,Q as I,Sb as _e,Tb as Ie,Vb as ge,X as r,Xa as J,Xb as Se,Y as _,Ya as Q,Yb as be,Z as f,Zb as ve,b as R,c as L,d as M,db as Y,ea as U,fa as z,fb as Z,gb as ee,hb as te,ia as v,ib as ie,j as g,ja as y,jb as ne,k as N,kb as oe,lb as ae,mb as re,ob as le,pb as ce,sa as $,ta as j,tb as se,ua as V,ub as me,v as i,zb as pe}from"./chunk-UWOWUE4S.js";import{e as T}from"./chunk-XD4PSF4R.js";var Ve=E("FileOpener");var x=E("Filesystem",{web:()=>import("./chunk-UAWERLD3.js").then(a=>new a.FilesystemWeb)});var Ke=E("BlobWriter");function Je(a){return window.btoa(Array.from(new Uint8Array(a)).map(function(l){return String.fromCharCode(l)}).join(""))}function Qe({path:a,directory:l,blob:n,recursive:m}){return x.writeFile({directory:l,path:a,recursive:m,data:""}).then(function(){return new Promise(function(p,t){function u(h){t(h.target.error)}let d=window.indexedDB.open("Disc");d.onerror=u,d.onsuccess=function(){let P=d.result.transaction("FileStorage","readwrite");P.onerror=u;let A=P.objectStore("FileStorage"),k=`/${l}/${a.replace(/^\//,"")}`,F=A.get(k);F.onsuccess=function(){F.result.size=n.size,F.result.content=n;let qe=A.put(F.result);qe.onsuccess=function(){p(void 0)}}}})})}function Ge({path:a,directory:l,blob:n,recursive:m}){return x.writeFile({directory:l,path:a,recursive:m,data:""}).then(function p(){if(n.size===0)return Promise.resolve();let t=3*128*1024,u=n.slice(0,t);return n=n.slice(t),new Response(u).arrayBuffer().then(function(h){return x.appendFile({directory:l,path:a,data:Je(h)})}).then(p)})}function Xe(a){let{path:l,directory:n,blob:m,fast_mode:p=!1,recursive:t,on_fallback:u}=a;return!m||!Number.isSafeInteger(m.size)||typeof m.type!="string"?Promise.reject(new Error("Not a Blob.")):je.getPlatform()==="web"?p?Qe(a):Ge(a):Promise.all([Ke.get_config(),x.getUri({path:l,directory:n})]).then(function([d,h]){let P=h.uri.replace("file://","");return(window.CapacitorWebFetch||window.fetch)(d.base_url+P+(t?"?recursive=true":""),{headers:{authorization:d.auth_token},method:"put",body:m}).then(function(k){if(k.status!==204)throw new Error("Bad HTTP status: "+k.status);return h.uri})}).catch(function(h){return u!==void 0&&u(h),Ge(a)})}var We=Object.freeze(Xe);var Ye=()=>["/home"];function Ze(a,l){if(a&1&&s(0,"ion-img-viewer",11),a&2){let n=I();c("src",n.photosDirectory+n.currentInspection.fotoLicencia)}}function et(a,l){a&1&&(e(0,"ion-label"),r(1,"Sin registro"),o())}function tt(a,l){if(a&1&&(e(0,"ion-col")(1,"ion-card")(2,"ion-card-header")(3,"ion-card-title"),r(4),o()(),e(5,"ion-card-content"),s(6,"ion-img-viewer",14),o()()()),a&2){let n=I().$implicit,m=I(2);i(4),_(n.auto_part==null?null:n.auto_part.descPieza),i(2),c("title",(n.auto_part==null?null:n.auto_part.descPieza)+" OUT")("src",m.photosDirectory+n.foto)}}function it(a,l){if(a&1&&S(0,tt,7,3,"ion-col"),a&2){let n=l.$implicit;b(0,n.etapa=="checkout"?0:-1)}}function nt(a,l){if(a&1&&(e(0,"ion-grid"),w(1,it,1,1,null,null,C),o()),a&2){let n=I();i(),D(n.currentInspection.photos)}}function ot(a,l){a&1&&(e(0,"ion-item")(1,"ion-label"),r(2,"Sin registro"),o()())}function at(a,l){if(a&1&&(e(0,"ion-item")(1,"ion-checkbox",15),r(2),o()()),a&2){let n=l.$implicit;i(),c("checked",!0)("value",n.idAccesorio),i(),_(n.nomAccesorio)}}function rt(a,l){a&1&&(e(0,"ion-item")(1,"ion-label"),r(2,"Sin Registro"),o()())}function lt(a,l){if(a&1&&s(0,"ion-img-viewer",12),a&2){let n=I();c("src",n.photosDirectory+n.currentInspection.firmaClienteSalida)}}function ct(a,l){a&1&&(e(0,"ion-label"),r(1,"Sin Registro"),o())}function st(a,l){if(a&1&&(e(0,"ion-col")(1,"ion-card")(2,"ion-card-header")(3,"ion-card-subtitle"),r(4),o(),e(5,"ion-card-title"),r(6),o()(),e(7,"ion-card-content"),s(8,"ion-img-viewer",14),o()()()),a&2){let n=l.$implicit,m=I(3);i(4),_(n.damage_type==null?null:n.damage_type.descTipoDanio),i(2),_(n.damage_part==null?null:n.damage_part.descPieza),i(2),c("title",(n.damage_part==null?null:n.damage_part.descPieza)+" IN")("src",m.photosDirectory+(n.photo==null?null:n.photo.foto))}}function mt(a,l){if(a&1&&(e(0,"ion-grid"),w(1,st,9,4,"ion-col",null,C),o()),a&2){let n=I(2);i(),D(n.currentInspection.damages)}}function pt(a,l){a&1&&(e(0,"ion-item")(1,"ion-label"),r(2,"Sin Registro"),o()())}function dt(a,l){if(a&1&&(e(0,"ion-item")(1,"ion-checkbox",15),r(2),o()()),a&2){let n=l.$implicit;i(),c("checked",!0)("value",n.idAccesorio),i(),_(n.nomAccesorio)}}function ut(a,l){a&1&&(e(0,"ion-item")(1,"ion-label"),r(2,"Sin Registro"),o()())}function ft(a,l){if(a&1&&s(0,"ion-img-viewer",16),a&2){let n=I(2);c("src",n.photosDirectory+n.currentInspection.firmaClienteEntrega)}}function ht(a,l){a&1&&(e(0,"ion-label"),r(1,"Sin Registro"),o())}function _t(a,l){if(a&1&&(e(0,"ion-card",8)(1,"ion-card-header")(2,"ion-card-title"),r(3,"Entrada"),o()(),e(4,"ion-card-content")(5,"ion-list")(6,"ion-list-header")(7,"ion-label"),r(8,"Datos Generales"),o()(),e(9,"ion-item"),s(10,"fa-icon",9),e(11,"ion-label"),r(12),o()(),e(13,"ion-item"),s(14,"fa-icon",9),e(15,"ion-label"),r(16),v(17,"number"),o()(),e(18,"ion-item"),s(19,"fa-icon",9),e(20,"ion-label"),r(21),o()(),e(22,"ion-item"),s(23,"fa-icon",9),e(24,"ion-label"),r(25),o()(),e(26,"ion-item"),s(27,"fa-icon",9),e(28,"ion-label"),r(29),v(30,"date"),o()(),e(31,"ion-item"),s(32,"fa-icon",9),e(33,"ion-label"),r(34),v(35,"date"),o()(),e(36,"ion-item",10),s(37,"fa-icon",9),e(38,"ion-label"),r(39,"Da\xF1os:"),o()(),S(40,mt,3,0,"ion-grid")(41,pt,3,0),o(),e(42,"ion-list")(43,"ion-list-header")(44,"ion-label"),r(45,"Accesorios"),o()(),w(46,dt,3,3,"ion-item",null,C,!1,ut,3,0,"ion-item"),o(),e(49,"ion-list")(50,"ion-list-header")(51,"ion-label"),r(52,"Adicional"),o()(),e(53,"ion-item",10),s(54,"fa-icon",9),e(55,"ion-label"),r(56,"Observaciones de Entrada: "),o()(),e(57,"ion-item")(58,"ion-label"),r(59),o()(),e(60,"ion-item",10)(61,"ion-label"),r(62,"Firma del cliente"),o()(),e(63,"ion-item"),S(64,ft,1,1,"ion-img-viewer",16)(65,ht,2,0),o()()()()),a&2){let n=I();i(10),c("icon",n.agency),i(2),f("Agencia: ",n.currentInspection.contract==null||n.currentInspection.contract.check_in_agency==null?null:n.currentInspection.contract.check_in_agency.descAgencia,""),i(2),c("icon",n.gauge),i(2),f("Kilometraje: ",y(17,18,n.currentInspection.odoEntrega,"0.0"),""),i(3),c("icon",n.gas),i(2),f("Nivel de Combustible: ",n.currentInspection.check_in_fuel==null?null:n.currentInspection.check_in_fuel.descTanqueComb,""),i(2),c("icon",n.agent),i(2),f("Agente: ",n.currentInspection.checkin_agent==null?null:n.currentInspection.checkin_agent.nomUsuario,""),i(2),c("icon",n.calendar),i(2),f("Fecha y Hora: ",y(30,21,n.currentInspection.contract==null?null:n.currentInspection.contract.fechaEntrega,"dd/MM/yyyy HH:mm"),""),i(3),c("icon",n.calendar),i(2),f("Fecha y Hora de Ingreso: ",y(35,24,n.currentInspection.updated_at,"dd/MM/yyyy HH:mm"),""),i(3),c("icon",n.cam),i(3),b(40,n.currentInspection.damages.length>0?40:41),i(6),D(n.currentInspection.checkin_accessories),i(8),c("icon",n.message),i(5),_(n.currentInspection.otrasObservacionesEntrega||"Sin Registro"),i(5),b(64,n.currentInspection.firmaClienteEntrega!=null?64:65)}}var Qt=(()=>{let l=class l{constructor(){this.inspectionService=g(xe),this.accessoriesService=g(ye),this.alertsService=g(ve),this.platform=g(J),this.route=g(G),this.router=g(W),this.navCtrl=g(Q),this.currentInspection={},this.photosDirectory=be.imagesUrl,this.agency=De,this.gauge=Te,this.gas=Fe,this.bar=Pe,this.user=Ne,this.car=Me,this.contract=Ue,this.agent=Be,this.licence=Le,this.cam=Oe,this.wheel=ke,this.battery=Ae,this.options=Re,this.calendar=He,this.message=we,this.accessories=this.accessoriesService.accessories(),this.actionSheetButtons=[{text:"Imprimir",role:"print",handler:()=>{this.print()}}],this.isActionSheetOpen=!1,this.route.queryParams.subscribe(()=>{var m,p;(m=this.router.getCurrentNavigation())!=null&&m.extras.state?this.currentInspection=(p=this.inspectionService.inspections())==null?void 0:p.find(t=>{var u,d,h;return t.idInspeccion==((h=(d=(u=this.router.getCurrentNavigation())==null?void 0:u.extras)==null?void 0:d.state)==null?void 0:h.idInspeccion)}):this.navCtrl.back()})}ngOnInit(){}ngOnDestroy(){this.inspectionService.currentInspection.set(void 0)}print(){return T(this,null,function*(){var m;yield this.alertsService.presentLoading(),(yield this.inspectionService.printInspection((m=this.currentInspection)==null?void 0:m.idInspeccion)).pipe(L(3),R(p=>(this.alertsService.dismissDefaultLoading(),this.alertsService.basicAlert("Error",`Ocurri\xF3 un error al conectarse al servidor: ${p.statusText}`,["Ok"]),[])),M(1)).subscribe(p=>{this.alertsService.dismissDefaultLoading(),this._print(p.data)})})}setOpen(m){this.isActionSheetOpen=m}_print(m){return T(this,null,function*(){let p=new Uint8Array(atob(m).split("").map(d=>d.charCodeAt(0))),t=new Blob([p],{type:"application/pdf"}),u=URL.createObjectURL(t);if(this.platform.is("mobile")){let d={filePath:yield this._getFilePath(`${this.currentInspection.numInspeccion}.pdf`,t),contentType:"application/pdf"};yield Ve.open(d).then(()=>{}).catch(h=>{console.error(h)})}else if(this.platform.is("desktop")||this.platform.is("mobileweb")){let d=document.createElement("iframe");d.style.display="none",d.src=u,document.body.appendChild(d),d.contentWindow.print()}})}_getFilePath(m,p){return T(this,null,function*(){let t=m;try{return yield this._saveBlobFile(p,t)}catch{yield x.getUri({path:t,directory:O.Cache}).then(u=>u.uri).catch(u=>{throw console.error(u),new Error("Cannot save/open the file")})}})}_saveBlobFile(m,p){return We({path:p,directory:O.Cache,blob:m})}};l.\u0275fac=function(p){return new(p||l)},l.\u0275cmp=N({type:l,selectors:[["app-inspection-detail"]],standalone:!0,features:[U],decls:135,vars:54,consts:[[1,"ion-no-border"],["color","primary"],["slot","start"],["routerDirection","root","src","assets/img/logo.png","width","30%",3,"routerLink"],[2,"margin-left","10px"],["slot","end"],["expand","block","fill","clear","shape","round",3,"click"],["slot","start",2,"color","white",3,"icon"],[2,"border-radius","10px"],["slot","start",3,"icon"],["lines","none"],["title","Licencia","text","Preview","scheme","light",3,"src"],["title","Firma del Cliente OUT","text","Preview","scheme","light",3,"src"],["header","Actions",3,"didDismiss","isOpen","buttons"],["text","Preview","scheme","light",3,"title","src"],["disabled","",3,"checked","value"],["title","Firma del Cliente IN","text","Preview","scheme","light",3,"src"]],template:function(p,t){p&1&&(e(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2),s(3,"ion-menu-button")(4,"img",3),e(5,"ion-title",4),r(6,"Inspecciones"),o()(),e(7,"ion-buttons",5)(8,"ion-button",6),B("click",function(){return t.setOpen(!0)}),s(9,"fa-icon",7),o()()()(),e(10,"ion-content")(11,"ion-card",8)(12,"ion-card-header")(13,"ion-card-title"),r(14),o()(),e(15,"ion-card-content")(16,"ion-list")(17,"ion-item"),s(18,"fa-icon",9),r(19),o(),e(20,"ion-item"),s(21,"fa-icon",9),e(22,"ion-label"),r(23),o()(),e(24,"ion-item"),s(25,"fa-icon",9),e(26,"ion-label"),r(27),o()(),e(28,"ion-item"),s(29,"fa-icon",9),e(30,"ion-label"),r(31),o()()()()(),e(32,"ion-card",8)(33,"ion-card-header")(34,"ion-card-title"),r(35,"Salida"),o()(),e(36,"ion-card-content")(37,"ion-list")(38,"ion-list-header")(39,"ion-label"),r(40,"Datos Generales"),o()(),e(41,"ion-item"),s(42,"fa-icon",9),e(43,"ion-label"),r(44),o()(),e(45,"ion-item"),s(46,"fa-icon",9),e(47,"ion-label"),r(48),v(49,"number"),o()(),e(50,"ion-item"),s(51,"fa-icon",9),e(52,"ion-label"),r(53),o()(),e(54,"ion-item"),s(55,"fa-icon",9),e(56,"ion-label"),r(57),o()(),e(58,"ion-item"),s(59,"fa-icon",9),e(60,"ion-label"),r(61),v(62,"date"),o()(),e(63,"ion-item"),s(64,"fa-icon",9),e(65,"ion-label"),r(66),v(67,"date"),o()(),e(68,"ion-item",10),s(69,"fa-icon",9),e(70,"ion-label"),r(71,"Licencia:"),o()(),e(72,"ion-item"),S(73,Ze,1,1,"ion-img-viewer",11)(74,et,2,0),o(),e(75,"ion-item",10),s(76,"fa-icon",9),e(77,"ion-label"),r(78,"Fotograf\xEDas:"),o()(),S(79,nt,3,0,"ion-grid")(80,ot,3,0),o(),e(81,"ion-list")(82,"ion-list-header")(83,"ion-label"),r(84,"Accesorios"),o()(),w(85,at,3,3,"ion-item",null,C,!1,rt,3,0,"ion-item"),o(),e(88,"ion-list")(89,"ion-list-header")(90,"ion-label"),r(91,"Adicional"),o()(),e(92,"ion-item",10),s(93,"fa-icon",9),e(94,"ion-label"),r(95,"Notas Llantas Delanteras: "),o()(),e(96,"ion-item")(97,"ion-label"),r(98),o()(),e(99,"ion-item",10),s(100,"fa-icon",9),e(101,"ion-label"),r(102,"Notas Llantas Traseras: "),o()(),e(103,"ion-item")(104,"ion-label"),r(105),o()(),e(106,"ion-item",10),s(107,"fa-icon",9),e(108,"ion-label"),r(109,"Notas Llanta Repuesto: "),o()(),e(110,"ion-item")(111,"ion-label"),r(112),o()(),e(113,"ion-item",10),s(114,"fa-icon",9),e(115,"ion-label"),r(116,"Notas bater\xEDa: "),o()(),e(117,"ion-item")(118,"ion-label"),r(119),o()(),e(120,"ion-item",10),s(121,"fa-icon",9),e(122,"ion-label"),r(123,"Otras Observaciones: "),o()(),e(124,"ion-item")(125,"ion-label"),r(126),o()(),e(127,"ion-item",10)(128,"ion-label"),r(129,"Firma del Cliente"),o()(),e(130,"ion-item"),S(131,lt,1,1,"ion-img-viewer",12)(132,ct,2,0),o()()()(),S(133,_t,66,27,"ion-card",8),e(134,"ion-action-sheet",13),B("didDismiss",function(){return t.setOpen(!1)}),o()()),p&2&&(i(4),c("routerLink",z(53,Ye)),i(5),c("icon",t.options),i(5),f("Inspecci\xF3n No. ",t.currentInspection.numInspeccion,""),i(4),c("icon",t.bar),i(),f(" Estado: ",t.currentInspection.state==null?null:t.currentInspection.state.descEstado," "),i(2),c("icon",t.contract),i(2),f("Contrato No: ",t.currentInspection.contract==null?null:t.currentInspection.contract.numContrato," "),i(2),c("icon",t.user),i(2),f("Cliente: ",t.currentInspection.contract==null||t.currentInspection.contract.customer==null?null:t.currentInspection.contract.customer.nomCliente,""),i(2),c("icon",t.car),i(2),H("Veh\xEDculo: ",t.currentInspection.car==null?null:t.currentInspection.car.nemVehiculo," | ",t.currentInspection.car==null||t.currentInspection.car.model==null||t.currentInspection.car.model.brand==null?null:t.currentInspection.car.model.brand.descMarca," ",t.currentInspection.car==null?null:t.currentInspection.car.modelo,""),i(11),c("icon",t.agency),i(2),f("Agencia: ",t.currentInspection.contract==null||t.currentInspection.contract.check_out_agency==null?null:t.currentInspection.contract.check_out_agency.descAgencia,""),i(2),c("icon",t.gauge),i(2),f("Kilometraje: ",y(49,44,t.currentInspection.odoSalida,"0.0"),""),i(3),c("icon",t.gas),i(2),f("Nivel de Combustible: ",t.currentInspection.check_out_fuel==null?null:t.currentInspection.check_out_fuel.descTanqueComb,""),i(2),c("icon",t.agent),i(2),f("Agente: ",t.currentInspection.checkout_agent==null?null:t.currentInspection.checkout_agent.nomUsuario,""),i(2),c("icon",t.calendar),i(2),f("Fecha y Hora: ",y(62,47,t.currentInspection.contract==null?null:t.currentInspection.contract.fechaSalida,"dd/MM/yyyy HH:mm"),""),i(3),c("icon",t.calendar),i(2),f("Fecha y Hora de Ingreso: ",y(67,50,t.currentInspection.created_at,"dd/MM/yyyy HH:mm"),""),i(3),c("icon",t.licence),i(4),b(73,t.currentInspection.fotoLicencia!=null?73:74),i(3),c("icon",t.cam),i(3),b(79,(t.currentInspection.photos==null?null:t.currentInspection.photos.length)>0?79:80),i(6),D(t.currentInspection.checkout_accessories),i(8),c("icon",t.wheel),i(5),_(t.currentInspection.comentariosLlantasDelanteras||"Sin Registro"),i(2),c("icon",t.wheel),i(5),_(t.currentInspection.comentariosLlantasTraseras||"Sin Registro"),i(2),c("icon",t.wheel),i(5),_(t.currentInspection.comentariosLlantaRepuesto||"Sin Registro"),i(2),c("icon",t.battery),i(5),_(t.currentInspection.comentariosBateria||"Sin Registro"),i(2),c("icon",t.message),i(5),_(t.currentInspection.otrasObservacionesSalida||"Sin Registro"),i(5),b(131,t.currentInspection.firmaClienteSalida!=null?131:132),i(2),b(133,t.currentInspection.idEstado==49?133:-1),i(),c("isOpen",t.isActionSheetOpen)("buttons",t.actionSheetButtons))},dependencies:[Se,Y,Z,ee,te,ie,ne,oe,ae,re,le,ce,se,me,pe,de,ue,fe,he,_e,Ie,X,ge,V,j,$,Ce,Ee,$e,ze,K,q],styles:["ion-checkbox.checkbox-disabled[_ngcontent-%COMP%]{opacity:1}"]});let a=l;return a})();export{Qt as a};
