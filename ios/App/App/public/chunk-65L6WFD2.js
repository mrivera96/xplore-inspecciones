import{a as ne}from"./chunk-P4PRXZGJ.js";import{a as ee,b as ie}from"./chunk-HUIOHKJA.js";import{a as Nt,b as Vt,c as Rt,d as Ut,e as Bt,f as $t,g as Gt,i as zt,k as qt,m as jt,p as Qt,q as Ht,r as Xt,s as Yt,t as Kt,u as Jt,v as Zt}from"./chunk-7JYYFWPO.js";import"./chunk-56TNLAWK.js";import{a as Ft,c as At,d as Ot}from"./chunk-3Z42Z5P2.js";import"./chunk-HCFXBRVH.js";import{$ as Z,$a as ct,A as E,Cb as It,Db as kt,E as f,Eb as Pt,G as I,Ga as ot,H as F,I as A,J as O,K as r,L as c,Lb as Tt,M as g,Ma as at,N as U,P as N,Q as y,Qa as rt,Tb as Mt,U as B,V as $,Va as st,W as G,X as u,Xb as Dt,Y as C,Ya as lt,Yb as Wt,Z as k,Zb as Lt,_b as te,aa as z,ba as q,ca as j,cb as dt,ea as tt,fb as ht,gb as mt,hb as ut,ia as Q,ib as pt,j as b,ja as H,jb as _t,k as J,kb as gt,lb as ft,ma as et,mb as vt,o as T,ob as Ct,p as M,pb as xt,sb as St,ta as it,tb as yt,ua as nt,v as d,vb as wt,yb as bt,zb as Et}from"./chunk-UWOWUE4S.js";import"./chunk-BSN2JFBO.js";import"./chunk-ON2Z5523.js";import"./chunk-JNTQS7SG.js";import"./chunk-4PGTP63H.js";import"./chunk-HC6MZPB3.js";import"./chunk-QRDTLJMM.js";import"./chunk-SNYBEKMS.js";import"./chunk-5GDE5I7K.js";import"./chunk-CUAZPCFG.js";import"./chunk-KYGY6K7Z.js";import"./chunk-5AWJTBLE.js";import"./chunk-C4BIBDV4.js";import"./chunk-4537AK5U.js";import"./chunk-MM5QLNJM.js";import"./chunk-3573TPBU.js";import"./chunk-2EOHHFOF.js";import"./chunk-JXIEZMHN.js";import"./chunk-2UEEUHXC.js";import"./chunk-MCRJI3T3.js";import"./chunk-FOZNFNPM.js";import"./chunk-G5HA7YTQ.js";import{a as R,e as K}from"./chunk-XD4PSF4R.js";var D=class{constructor(t,e,i,o){if(isNaN(t)||isNaN(e))throw new Error(`Point is invalid: (${t}, ${e})`);this.x=+t,this.y=+e,this.pressure=i||0,this.time=o||Date.now()}distanceTo(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))}equals(t){return this.x===t.x&&this.y===t.y&&this.pressure===t.pressure&&this.time===t.time}velocityFrom(t){return this.time!==t.time?this.distanceTo(t)/(this.time-t.time):0}},X=class s{static fromPoints(t,e){let i=this.calculateControlPoints(t[0],t[1],t[2]).c2,o=this.calculateControlPoints(t[1],t[2],t[3]).c1;return new s(t[1],i,o,t[2],e.start,e.end)}static calculateControlPoints(t,e,i){let o=t.x-e.x,n=t.y-e.y,a=e.x-i.x,p=e.y-i.y,m={x:(t.x+e.x)/2,y:(t.y+e.y)/2},h={x:(e.x+i.x)/2,y:(e.y+i.y)/2},_=Math.sqrt(o*o+n*n),l=Math.sqrt(a*a+p*p),x=m.x-h.x,S=m.y-h.y,v=l/(_+l),w={x:h.x+x*v,y:h.y+S*v},W=e.x-w.x,P=e.y-w.y;return{c1:new D(m.x+W,m.y+P),c2:new D(h.x+W,h.y+P)}}constructor(t,e,i,o,n,a){this.startPoint=t,this.control2=e,this.control1=i,this.endPoint=o,this.startWidth=n,this.endWidth=a}length(){let e=0,i,o;for(let n=0;n<=10;n+=1){let a=n/10,p=this.point(a,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),m=this.point(a,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(n>0){let h=p-i,_=m-o;e+=Math.sqrt(h*h+_*_)}i=p,o=m}return e}point(t,e,i,o,n){return e*(1-t)*(1-t)*(1-t)+3*i*(1-t)*(1-t)*t+3*o*(1-t)*t*t+n*t*t*t}},Y=class{constructor(){try{this._et=new EventTarget}catch{this._et=document}}addEventListener(t,e,i){this._et.addEventListener(t,e,i)}dispatchEvent(t){return this._et.dispatchEvent(t)}removeEventListener(t,e,i){this._et.removeEventListener(t,e,i)}};function oe(s,t=250){let e=0,i=null,o,n,a,p=()=>{e=Date.now(),i=null,o=s.apply(n,a),i||(n=null,a=[])};return function(...h){let _=Date.now(),l=t-(_-e);return n=this,a=h,l<=0||l>t?(i&&(clearTimeout(i),i=null),e=_,o=s.apply(n,a),i||(n=null,a=[])):i||(i=window.setTimeout(p,l)),o}}var V=class s extends Y{constructor(t,e={}){super(),this.canvas=t,this._drawingStroke=!1,this._isEmpty=!0,this._lastPoints=[],this._data=[],this._lastVelocity=0,this._lastWidth=0,this._handleMouseDown=i=>{i.buttons===1&&this._strokeBegin(i)},this._handleMouseMove=i=>{this._strokeMoveUpdate(i)},this._handleMouseUp=i=>{i.buttons===1&&this._strokeEnd(i)},this._handleTouchStart=i=>{if(i.cancelable&&i.preventDefault(),i.targetTouches.length===1){let o=i.changedTouches[0];this._strokeBegin(o)}},this._handleTouchMove=i=>{i.cancelable&&i.preventDefault();let o=i.targetTouches[0];this._strokeMoveUpdate(o)},this._handleTouchEnd=i=>{if(i.target===this.canvas){i.cancelable&&i.preventDefault();let n=i.changedTouches[0];this._strokeEnd(n)}},this._handlePointerStart=i=>{i.preventDefault(),this._strokeBegin(i)},this._handlePointerMove=i=>{this._strokeMoveUpdate(i)},this._handlePointerEnd=i=>{this._drawingStroke&&(i.preventDefault(),this._strokeEnd(i))},this.velocityFilterWeight=e.velocityFilterWeight||.7,this.minWidth=e.minWidth||.5,this.maxWidth=e.maxWidth||2.5,this.throttle="throttle"in e?e.throttle:16,this.minDistance="minDistance"in e?e.minDistance:5,this.dotSize=e.dotSize||0,this.penColor=e.penColor||"black",this.backgroundColor=e.backgroundColor||"rgba(0,0,0,0)",this.compositeOperation=e.compositeOperation||"source-over",this.canvasContextOptions="canvasContextOptions"in e?e.canvasContextOptions:{},this._strokeMoveUpdate=this.throttle?oe(s.prototype._strokeUpdate,this.throttle):s.prototype._strokeUpdate,this._ctx=t.getContext("2d",this.canvasContextOptions),this.clear(),this.on()}clear(){let{_ctx:t,canvas:e}=this;t.fillStyle=this.backgroundColor,t.clearRect(0,0,e.width,e.height),t.fillRect(0,0,e.width,e.height),this._data=[],this._reset(this._getPointGroupOptions()),this._isEmpty=!0}fromDataURL(t,e={}){return new Promise((i,o)=>{let n=new Image,a=e.ratio||window.devicePixelRatio||1,p=e.width||this.canvas.width/a,m=e.height||this.canvas.height/a,h=e.xOffset||0,_=e.yOffset||0;this._reset(this._getPointGroupOptions()),n.onload=()=>{this._ctx.drawImage(n,h,_,p,m),i()},n.onerror=l=>{o(l)},n.crossOrigin="anonymous",n.src=t,this._isEmpty=!1})}toDataURL(t="image/png",e){switch(t){case"image/svg+xml":return typeof e!="object"&&(e=void 0),`data:image/svg+xml;base64,${btoa(this.toSVG(e))}`;default:return typeof e!="number"&&(e=void 0),this.canvas.toDataURL(t,e)}}on(){this.canvas.style.touchAction="none",this.canvas.style.msTouchAction="none",this.canvas.style.userSelect="none";let t=/Macintosh/.test(navigator.userAgent)&&"ontouchstart"in document;window.PointerEvent&&!t?this._handlePointerEvents():(this._handleMouseEvents(),"ontouchstart"in window&&this._handleTouchEvents())}off(){this.canvas.style.touchAction="auto",this.canvas.style.msTouchAction="auto",this.canvas.style.userSelect="auto",this.canvas.removeEventListener("pointerdown",this._handlePointerStart),this.canvas.removeEventListener("pointermove",this._handlePointerMove),this.canvas.ownerDocument.removeEventListener("pointerup",this._handlePointerEnd),this.canvas.removeEventListener("mousedown",this._handleMouseDown),this.canvas.removeEventListener("mousemove",this._handleMouseMove),this.canvas.ownerDocument.removeEventListener("mouseup",this._handleMouseUp),this.canvas.removeEventListener("touchstart",this._handleTouchStart),this.canvas.removeEventListener("touchmove",this._handleTouchMove),this.canvas.removeEventListener("touchend",this._handleTouchEnd)}isEmpty(){return this._isEmpty}fromData(t,{clear:e=!0}={}){e&&this.clear(),this._fromData(t,this._drawCurve.bind(this),this._drawDot.bind(this)),this._data=this._data.concat(t)}toData(){return this._data}_getPointGroupOptions(t){return{penColor:t&&"penColor"in t?t.penColor:this.penColor,dotSize:t&&"dotSize"in t?t.dotSize:this.dotSize,minWidth:t&&"minWidth"in t?t.minWidth:this.minWidth,maxWidth:t&&"maxWidth"in t?t.maxWidth:this.maxWidth,velocityFilterWeight:t&&"velocityFilterWeight"in t?t.velocityFilterWeight:this.velocityFilterWeight,compositeOperation:t&&"compositeOperation"in t?t.compositeOperation:this.compositeOperation}}_strokeBegin(t){if(!this.dispatchEvent(new CustomEvent("beginStroke",{detail:t,cancelable:!0})))return;this._drawingStroke=!0;let i=this._getPointGroupOptions(),o=Object.assign(Object.assign({},i),{points:[]});this._data.push(o),this._reset(i),this._strokeUpdate(t)}_strokeUpdate(t){if(!this._drawingStroke)return;if(this._data.length===0){this._strokeBegin(t);return}this.dispatchEvent(new CustomEvent("beforeUpdateStroke",{detail:t}));let e=t.clientX,i=t.clientY,o=t.pressure!==void 0?t.pressure:t.force!==void 0?t.force:0,n=this._createPoint(e,i,o),a=this._data[this._data.length-1],p=a.points,m=p.length>0&&p[p.length-1],h=m?n.distanceTo(m)<=this.minDistance:!1,_=this._getPointGroupOptions(a);if(!m||!(m&&h)){let l=this._addPoint(n,_);m?l&&this._drawCurve(l,_):this._drawDot(n,_),p.push({time:n.time,x:n.x,y:n.y,pressure:n.pressure})}this.dispatchEvent(new CustomEvent("afterUpdateStroke",{detail:t}))}_strokeEnd(t){this._drawingStroke&&(this._strokeUpdate(t),this._drawingStroke=!1,this.dispatchEvent(new CustomEvent("endStroke",{detail:t})))}_handlePointerEvents(){this._drawingStroke=!1,this.canvas.addEventListener("pointerdown",this._handlePointerStart),this.canvas.addEventListener("pointermove",this._handlePointerMove),this.canvas.ownerDocument.addEventListener("pointerup",this._handlePointerEnd)}_handleMouseEvents(){this._drawingStroke=!1,this.canvas.addEventListener("mousedown",this._handleMouseDown),this.canvas.addEventListener("mousemove",this._handleMouseMove),this.canvas.ownerDocument.addEventListener("mouseup",this._handleMouseUp)}_handleTouchEvents(){this.canvas.addEventListener("touchstart",this._handleTouchStart),this.canvas.addEventListener("touchmove",this._handleTouchMove),this.canvas.addEventListener("touchend",this._handleTouchEnd)}_reset(t){this._lastPoints=[],this._lastVelocity=0,this._lastWidth=(t.minWidth+t.maxWidth)/2,this._ctx.fillStyle=t.penColor,this._ctx.globalCompositeOperation=t.compositeOperation}_createPoint(t,e,i){let o=this.canvas.getBoundingClientRect();return new D(t-o.left,e-o.top,i,new Date().getTime())}_addPoint(t,e){let{_lastPoints:i}=this;if(i.push(t),i.length>2){i.length===3&&i.unshift(i[0]);let o=this._calculateCurveWidths(i[1],i[2],e),n=X.fromPoints(i,o);return i.shift(),n}return null}_calculateCurveWidths(t,e,i){let o=i.velocityFilterWeight*e.velocityFrom(t)+(1-i.velocityFilterWeight)*this._lastVelocity,n=this._strokeWidth(o,i),a={end:n,start:this._lastWidth};return this._lastVelocity=o,this._lastWidth=n,a}_strokeWidth(t,e){return Math.max(e.maxWidth/(t+1),e.minWidth)}_drawCurveSegment(t,e,i){let o=this._ctx;o.moveTo(t,e),o.arc(t,e,i,0,2*Math.PI,!1),this._isEmpty=!1}_drawCurve(t,e){let i=this._ctx,o=t.endWidth-t.startWidth,n=Math.ceil(t.length())*2;i.beginPath(),i.fillStyle=e.penColor;for(let a=0;a<n;a+=1){let p=a/n,m=p*p,h=m*p,_=1-p,l=_*_,x=l*_,S=x*t.startPoint.x;S+=3*l*p*t.control1.x,S+=3*_*m*t.control2.x,S+=h*t.endPoint.x;let v=x*t.startPoint.y;v+=3*l*p*t.control1.y,v+=3*_*m*t.control2.y,v+=h*t.endPoint.y;let w=Math.min(t.startWidth+h*o,e.maxWidth);this._drawCurveSegment(S,v,w)}i.closePath(),i.fill()}_drawDot(t,e){let i=this._ctx,o=e.dotSize>0?e.dotSize:(e.minWidth+e.maxWidth)/2;i.beginPath(),this._drawCurveSegment(t.x,t.y,o),i.closePath(),i.fillStyle=e.penColor,i.fill()}_fromData(t,e,i){for(let o of t){let{points:n}=o,a=this._getPointGroupOptions(o);if(n.length>1)for(let p=0;p<n.length;p+=1){let m=n[p],h=new D(m.x,m.y,m.pressure,m.time);p===0&&this._reset(a);let _=this._addPoint(h,a);_&&e(_,a)}else this._reset(a),i(n[0],a)}}toSVG({includeBackgroundColor:t=!1}={}){let e=this._data,i=Math.max(window.devicePixelRatio||1,1),o=0,n=0,a=this.canvas.width/i,p=this.canvas.height/i,m=document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.setAttribute("xmlns","http://www.w3.org/2000/svg"),m.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),m.setAttribute("viewBox",`${o} ${n} ${a} ${p}`),m.setAttribute("width",a.toString()),m.setAttribute("height",p.toString()),t&&this.backgroundColor){let h=document.createElement("rect");h.setAttribute("width","100%"),h.setAttribute("height","100%"),h.setAttribute("fill",this.backgroundColor),m.appendChild(h)}return this._fromData(e,(h,{penColor:_})=>{let l=document.createElement("path");if(!isNaN(h.control1.x)&&!isNaN(h.control1.y)&&!isNaN(h.control2.x)&&!isNaN(h.control2.y)){let x=`M ${h.startPoint.x.toFixed(3)},${h.startPoint.y.toFixed(3)} C ${h.control1.x.toFixed(3)},${h.control1.y.toFixed(3)} ${h.control2.x.toFixed(3)},${h.control2.y.toFixed(3)} ${h.endPoint.x.toFixed(3)},${h.endPoint.y.toFixed(3)}`;l.setAttribute("d",x),l.setAttribute("stroke-width",(h.endWidth*2.25).toFixed(3)),l.setAttribute("stroke",_),l.setAttribute("fill","none"),l.setAttribute("stroke-linecap","round"),m.appendChild(l)}},(h,{penColor:_,dotSize:l,minWidth:x,maxWidth:S})=>{let v=document.createElement("circle"),w=l>0?l:(x+S)/2;v.setAttribute("r",w.toString()),v.setAttribute("cx",h.x.toString()),v.setAttribute("cy",h.y.toString()),v.setAttribute("fill",_),m.appendChild(v)}),m.outerHTML}};var ae=["canvas"],re=["signContainer"];function se(s,t){if(s&1&&g(0,"ion-img-viewer",14),s&2){let e,i=y(2);f("src","data:image/png;base64,"+((e=i.currentInspection())==null?null:e.fotoLicencia))}}function le(s,t){s&1&&(r(0,"ion-label"),u(1,"Sin registro"),c())}function ce(s,t){if(s&1&&(r(0,"ion-col")(1,"ion-card")(2,"ion-card-header")(3,"ion-card-title"),u(4),c()(),r(5,"ion-card-content"),g(6,"ion-img-viewer",17),c()()()),s&2){let e=y().$implicit;d(4),C(e.auto_part==null?null:e.auto_part.descPieza),d(2),f("title",(e.auto_part==null?null:e.auto_part.descPieza)+" OUT")("src","data:image/png;base64,"+e.foto)}}function de(s,t){if(s&1&&E(0,ce,7,3,"ion-col"),s&2){let e=t.$implicit;I(0,e.etapa=="checkout"?0:-1)}}function he(s,t){if(s&1&&(r(0,"ion-grid"),A(1,de,1,1,null,null,F),c()),s&2){let e,i=y(2);d(),O((e=i.currentInspection())==null?null:e.photos)}}function me(s,t){s&1&&(r(0,"ion-item")(1,"ion-label"),u(2,"Sin registro"),c()())}function ue(s,t){if(s&1&&(r(0,"ion-item")(1,"ion-checkbox",18),u(2),c()()),s&2){let e=t.$implicit;d(),f("checked",!0)("value",e.idAccesorio),d(),C(e.nomAccesorio)}}function pe(s,t){if(s&1){let e=U();r(0,"ion-list")(1,"ion-item"),g(2,"fa-icon",4),r(3,"ion-label"),u(4),Q(5,"number"),c()(),r(6,"ion-item"),g(7,"fa-icon",4),r(8,"ion-label"),u(9),c()(),r(10,"ion-item",13),g(11,"fa-icon",4),r(12,"ion-label"),u(13,"Licencia:"),c()(),r(14,"ion-item"),E(15,se,1,1,"ion-img-viewer",14)(16,le,2,0),c(),r(17,"ion-item",13),g(18,"fa-icon",4),r(19,"ion-label"),u(20,"Fotograf\xEDas:"),c()(),E(21,he,3,0,"ion-grid")(22,me,3,0),r(23,"ion-list-header")(24,"ion-label"),u(25,"Accesorios"),c()(),A(26,ue,3,3,"ion-item",null,F),r(28,"ion-list-header")(29,"ion-label"),u(30,"Adicional"),c()(),r(31,"ion-item",13),g(32,"fa-icon",4),r(33,"ion-label"),u(34,"Notas Llantas Delanteras: "),c()(),r(35,"ion-item")(36,"ion-label"),u(37),c()(),r(38,"ion-item",13),g(39,"fa-icon",4),r(40,"ion-label"),u(41,"Notas Llantas Traseras: "),c()(),r(42,"ion-item")(43,"ion-label"),u(44),c()(),r(45,"ion-item",13),g(46,"fa-icon",4),r(47,"ion-label"),u(48,"Notas Llanta Repuesto: "),c()(),r(49,"ion-item")(50,"ion-label"),u(51),c()(),r(52,"ion-item",13),g(53,"fa-icon",4),r(54,"ion-label"),u(55,"Notas bater\xEDa: "),c()(),r(56,"ion-item")(57,"ion-label"),u(58),c()(),r(59,"ion-item",13),g(60,"fa-icon",4),r(61,"ion-label"),u(62,"Otras Observaciones: "),c()(),r(63,"ion-item")(64,"ion-label"),u(65),c()(),r(66,"ion-item")(67,"ion-input",15),j("ngModelChange",function(o){T(e);let n=y();return q(n.notas.emailCliente,o)||(n.notas.emailCliente=o),M(o)}),c()(),r(68,"ion-item")(69,"ion-input",16),j("ngModelChange",function(o){T(e);let n=y();return q(n.notas.emailCC,o)||(n.notas.emailCC=o),M(o)}),c()()()}if(s&2){let e,i,o,n,a,p,m,h,_,l=y();d(2),f("icon",l.gauge),d(2),k("Kilometraje: ",H(5,20,(e=l.currentInspection())==null?null:e.odoSalida,"0.0"),""),d(3),f("icon",l.gas),d(2),k("Nivel de Combustible: ",l.currentFuel==null?null:l.currentFuel.descTanqueComb,""),d(2),f("icon",l.licence),d(4),I(15,((i=l.currentInspection())==null?null:i.fotoLicencia)!=null?15:16),d(3),f("icon",l.cam),d(3),I(21,((o=l.currentInspection())==null||o.photos==null?null:o.photos.length)>0?21:22),d(5),O((n=l.currentInspection())==null?null:n.accesoriosSalida),d(6),f("icon",l.wheel),d(5),C(((a=l.currentInspection())==null?null:a.comentariosLlantasDelanteras)||"Sin Registro"),d(2),f("icon",l.wheel),d(5),C(((p=l.currentInspection())==null?null:p.comentariosLlantasTraseras)||"Sin Registro"),d(2),f("icon",l.wheel),d(5),C(((m=l.currentInspection())==null?null:m.comentariosLlantaRepuesto)||"Sin Registro"),d(2),f("icon",l.battery),d(5),C(((h=l.currentInspection())==null?null:h.comentariosBateria)||"Sin Registro"),d(2),f("icon",l.message),d(5),C(((_=l.currentInspection())==null?null:_.otrasObservacionesSalida)||"Sin Registro"),d(2),z("ngModel",l.notas.emailCliente),d(2),z("ngModel",l.notas.emailCC)}}function _e(s,t){if(s&1&&(r(0,"ion-col")(1,"ion-card")(2,"ion-card-header")(3,"ion-card-subtitle"),u(4),c(),r(5,"ion-card-title"),u(6),c()(),r(7,"ion-card-content"),g(8,"ion-img-viewer",17),c()()()),s&2){let e=y().$implicit,i=y(3);d(4),C(e.damage==null||e.damage.damage_type==null?null:e.damage.damage_type.descTipoDanio),d(2),C(e.damage==null||e.damage.damage_part==null?null:e.damage.damage_part.descPieza),d(2),f("title",(e.damage==null||e.damage.damage_part==null?null:e.damage.damage_part.descPieza)+" IN")("src",e.foto.length>100?"data:image/png;base64,"+e.foto:i.photosDirectory+e.foto)}}function ge(s,t){if(s&1&&E(0,_e,9,4,"ion-col"),s&2){let e=t.$implicit;I(0,e.etapa=="checkin"?0:-1)}}function fe(s,t){if(s&1&&(r(0,"ion-grid"),A(1,ge,1,1,null,null,F),c()),s&2){let e,i=y(2);d(),O((e=i.currentInspection())==null?null:e.photos)}}function ve(s,t){s&1&&(r(0,"ion-item")(1,"ion-label"),u(2,"Sin Registro"),c()())}function Ce(s,t){if(s&1&&(r(0,"ion-item")(1,"ion-checkbox",18),u(2),c()()),s&2){let e=t.$implicit;d(),f("checked",!0)("value",e.idAccesorio),d(),C(e.nomAccesorio)}}function xe(s,t){if(s&1&&(r(0,"ion-list")(1,"ion-item"),g(2,"fa-icon",4),r(3,"ion-label"),u(4),Q(5,"number"),c()(),r(6,"ion-item"),g(7,"fa-icon",4),r(8,"ion-label"),u(9),c()(),r(10,"ion-item",13),g(11,"fa-icon",4),r(12,"ion-label"),u(13,"Da\xF1os:"),c()(),E(14,fe,3,0,"ion-grid")(15,ve,3,0),c(),r(16,"ion-list")(17,"ion-list-header")(18,"ion-label"),u(19,"Accesorios"),c()(),A(20,Ce,3,3,"ion-item",null,F),c(),r(22,"ion-list")(23,"ion-list-header")(24,"ion-label"),u(25,"Adicional"),c()(),r(26,"ion-item",13),g(27,"fa-icon",4),r(28,"ion-label"),u(29,"Observaciones de Entrada: "),c()(),r(30,"ion-item")(31,"ion-label"),u(32),c()()()),s&2){let e,i,o,n,a=y();d(2),f("icon",a.gauge),d(2),k("Kilometraje: ",H(5,8,(e=a.currentInspection())==null?null:e.odoEntrega,"0.0"),""),d(3),f("icon",a.gas),d(2),k("Nivel de Combustible: ",a.currentFuel==null?null:a.currentFuel.descTanqueComb,""),d(2),f("icon",a.cam),d(3),I(14,((i=a.currentInspection())==null||i.photos==null?null:i.photos.length)>0?14:15),d(6),O((o=a.currentInspection())==null?null:o.accesoriosEntrega),d(7),f("icon",a.message),d(5),C(((n=a.currentInspection())==null?null:n.otrasObservacionesEntrega)||"Sin Registro")}}var je=(()=>{let t=class t{constructor(){var i,o,n,a,p,m,h,_,l,x,S,v,w;this.inspectionsService=b(Ot),this.alertsService=b(Lt),this.fuelTanksService=b(ne),this.contractsService=b(Ft),this.carsService=b(At),this.navCtrl=b(lt),this.router=b(ot),this.notas={},this.canvas=void 0,this.signaturePad=void 0,this.currentInspection=this.inspectionsService.currentInspection,this.agency=Ut,this.gauge=zt,this.gas=Gt,this.bar=Bt,this.user=Kt,this.car=Yt,this.contract=Zt,this.agent=jt,this.licence=Xt,this.cam=Qt,this.wheel=$t,this.battery=qt,this.options=Ht,this.calendar=Jt,this.message=Rt,this.currentFuel=void 0,this.currentContract=this.contractsService.currentContract(),this.currentCar=this.carsService.currentCar(),this.photosDirectory=Wt.imagesUrl,et(()=>{var W;((W=this.currentInspection())==null?void 0:W.stage)=="checkout"?this.currentFuel=this.fuelTanksService.fuelTanks().find(P=>{var L;return P.idTanqueComb==((L=this.currentInspection())==null?void 0:L.combSalida)}):this.currentFuel=this.fuelTanksService.fuelTanks().find(P=>{var L;return P.idTanqueComb==((L=this.currentInspection())==null?void 0:L.combEntrega)})}),this.title=((i=this.inspectionsService.currentInspection())==null?void 0:i.stage)=="checkin"?" Checkin":" Checkout",this.notas.emailCliente=((o=this.currentInspection())==null?void 0:o.stage)==="checkout"?((m=(p=(a=(n=this.router.getCurrentNavigation())==null?void 0:n.extras)==null?void 0:a.state)==null?void 0:p.customer)==null?void 0:m.correoI)||"":(h=this.currentInspection())==null?void 0:h.correoCliente,this.notas.emailCC=((_=this.currentInspection())==null?void 0:_.stage)==="checkout"?((v=(S=(x=(l=this.router.getCurrentNavigation())==null?void 0:l.extras)==null?void 0:x.state)==null?void 0:S.driver)==null?void 0:v.correoI)||"":(w=this.currentInspection())==null?void 0:w.correoConductor}ngOnInit(){}ngOnDestroy(){var i;(i=this.signaturePad)==null||i.clear(),this.notas={}}ngAfterViewInit(){this.canvas=this.canvasref.nativeElement,this.canvas.width=window.innerWidth*.7,this.signaturePad=new V(this.canvas,{backgroundColor:"#f2f2f2"})}onClean(){var i;(i=this.signaturePad)==null||i.clear()}goToNext(){return K(this,null,function*(){var i,o;(i=this.signaturePad)!=null&&i.isEmpty()?this.alertsService.basicAlert("Atenci\xF3n!","\xBFDesea finalizar inspecci\xF3n sin firma del cliente?",[{text:"Ok",role:"ok",handler:()=>{var n;((n=this.currentInspection())==null?void 0:n.stage)=="checkout"?this.saveCheckout():this.saveCheckin()}},"Cancel"]):((o=this.currentInspection())==null?void 0:o.stage)=="checkout"?this.saveCheckout():this.saveCheckin()})}saveCheckout(){this.currentInspection.update(i=>{var n,a;let o=R({},i);return(n=this.signaturePad)!=null&&n.isEmpty()||(o.firmaClienteSalida=(a=this.signaturePad)==null?void 0:a.toDataURL("image/png")),o.correoCliente=this.notas.emailCliente,o.correoConductor=this.notas.emailCC,o}),this.inspectionsService.createInspection()}saveCheckin(){this.currentInspection.update(i=>{var n;let o=R({},i);return o.firmaClienteEntrega=(n=this.signaturePad)==null?void 0:n.toDataURL("image/png"),o.correoCliente=this.notas.emailCliente,o.correoConductor=this.notas.emailCC,o}),this.inspectionsService.closeInspection()}goToPrev(){this.navCtrl.back()}};t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=J({type:t,selectors:[["app-signing"]],viewQuery:function(o,n){if(o&1&&(B(ae,5),B(re,5)),o&2){let a;$(a=G())&&(n.canvasref=a.first),$(a=G())&&(n.signContainer=a.first)}},standalone:!0,features:[tt],decls:46,vars:10,consts:[["signContainer",""],["canvas",""],[3,"fullscreen"],["fixed",""],["slot","start",3,"icon"],[2,"justify-content","center"],["size","4"],["expand","full","fill","clear","shape","round",3,"click"],["slot","start"],[3,"click"],["slot","start","name","arrow-back"],["slot","end"],["slot","end","name","arrow-forward"],["lines","none"],["title","Licencia","text","Preview","scheme","light",3,"src"],["labelPlacement","stacked","type","text","placeholder","Email donde recibe copia el cliente","label","Email del cliente",3,"ngModelChange","ngModel"],["labelPlacement","stacked","type","text","placeholder","Email donde recibe copia el conductor","label","Email copia",3,"ngModelChange","ngModel"],["text","Preview","scheme","light",3,"title","src"],["disabled","",3,"checked","value"]],template:function(o,n){if(o&1){let a=U();g(0,"app-toolbar"),r(1,"ion-content",2)(2,"ion-grid",3)(3,"ion-card")(4,"ion-card-content")(5,"ion-list")(6,"ion-list-header")(7,"ion-label"),u(8,"Resumen de Inspeccion"),c()(),r(9,"ion-item"),g(10,"fa-icon",4),r(11,"ion-label"),u(12),c()(),r(13,"ion-item"),g(14,"fa-icon",4),r(15,"ion-label"),u(16),c()(),r(17,"ion-item"),g(18,"fa-icon",4),r(19,"ion-label"),u(20),c()()(),E(21,pe,70,23,"ion-list")(22,xe,33,11),c()(),r(23,"ion-card")(24,"ion-card-content")(25,"h3"),u(26,"Firma del cliente"),c(),r(27,"ion-grid",3)(28,"ion-row",5,0),g(30,"canvas",null,1),c(),r(32,"ion-row",5)(33,"ion-col",6)(34,"ion-button",7),N("click",function(){return T(a),M(n.onClean())}),u(35," Limpiar "),c()()()()()()()(),r(36,"ion-footer")(37,"ion-toolbar")(38,"ion-buttons",8)(39,"ion-button",9),N("click",function(){return T(a),M(n.goToPrev())}),u(40," Atr\xE1s "),g(41,"ion-icon",10),c()(),r(42,"ion-buttons",11)(43,"ion-button",9),N("click",function(){return T(a),M(n.goToNext())}),u(44," Finalizar "),g(45,"ion-icon",12),c()()()()}if(o&2){let a;d(),f("fullscreen",!0),d(9),f("icon",n.contract),d(2),k("Contrato No: ",n.currentContract.numContrato," "),d(2),f("icon",n.user),d(2),k("Cliente: ",n.currentContract.customer==null?null:n.currentContract.customer.nomCliente,""),d(2),f("icon",n.car),d(2),Z("Veh\xEDculo: ",n.currentCar.nemVehiculo," | ",n.currentCar.model==null||n.currentCar.model.brand==null?null:n.currentCar.model.brand.descMarca," ",n.currentCar.modelo,""),d(),I(21,((a=n.currentInspection())==null?null:a.stage)=="checkout"?21:((a=n.currentInspection())==null?null:a.stage)=="checkin"?22:-1)}},dependencies:[Dt,ht,mt,ut,pt,_t,gt,ft,vt,Ct,xt,St,yt,wt,bt,Et,It,kt,Pt,Tt,Mt,ct,dt,st,at,rt,te,Vt,Nt,nt,it,ie,ee]});let s=t;return s})();export{je as SigningComponent};
