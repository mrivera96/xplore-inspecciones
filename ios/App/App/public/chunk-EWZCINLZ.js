import{a as f,c as P,d as E}from"./chunk-LEX6B2L3.js";import{Xa as g,g as y,j as b,z as w}from"./chunk-UWOWUE4S.js";import{e as s}from"./chunk-XD4PSF4R.js";var m=function(n){return n.Prompt="PROMPT",n.Camera="CAMERA",n.Photos="PHOTOS",n}(m||{}),d=function(n){return n.Rear="REAR",n.Front="FRONT",n}(d||{}),h=function(n){return n.Uri="uri",n.Base64="base64",n.DataUrl="dataUrl",n}(h||{});var u=class extends E{getPhoto(e){return s(this,null,function*(){return new Promise((r,a)=>s(this,null,function*(){if(e.webUseInput||e.source===m.Photos)this.fileInputExperience(e,r,a);else if(e.source===m.Prompt){let t=document.querySelector("pwa-action-sheet");t||(t=document.createElement("pwa-action-sheet"),document.body.appendChild(t)),t.header=e.promptLabelHeader||"Photo",t.cancelable=!1,t.options=[{title:e.promptLabelPhoto||"From Photos"},{title:e.promptLabelPicture||"Take Picture"}],t.addEventListener("onSelection",i=>s(this,null,function*(){i.detail===0?this.fileInputExperience(e,r,a):this.cameraExperience(e,r,a)}))}else this.cameraExperience(e,r,a)}))})}pickImages(e){return s(this,null,function*(){return new Promise((r,a)=>s(this,null,function*(){this.multipleFileInputExperience(r,a)}))})}cameraExperience(e,r,a){return s(this,null,function*(){if(customElements.get("pwa-camera-modal")){let t=document.createElement("pwa-camera-modal");t.facingMode=e.direction===d.Front?"user":"environment",document.body.appendChild(t);try{yield t.componentOnReady(),t.addEventListener("onPhoto",i=>s(this,null,function*(){let o=i.detail;o===null?a(new f("User cancelled photos app")):o instanceof Error?a(o):r(yield this._getCameraPhoto(o,e)),t.dismiss(),document.body.removeChild(t)})),t.present()}catch{this.fileInputExperience(e,r,a)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),this.fileInputExperience(e,r,a)})}fileInputExperience(e,r,a){let t=document.querySelector("#_capacitor-camera-input"),i=()=>{var o;(o=t.parentNode)===null||o===void 0||o.removeChild(t)};t||(t=document.createElement("input"),t.id="_capacitor-camera-input",t.type="file",t.hidden=!0,document.body.appendChild(t),t.addEventListener("change",o=>{let c=t.files[0],l="jpeg";if(c.type==="image/png"?l="png":c.type==="image/gif"&&(l="gif"),e.resultType==="dataUrl"||e.resultType==="base64"){let p=new FileReader;p.addEventListener("load",()=>{if(e.resultType==="dataUrl")r({dataUrl:p.result,format:l});else if(e.resultType==="base64"){let L=p.result.split(",")[1];r({base64String:L,format:l})}i()}),p.readAsDataURL(c)}else r({webPath:URL.createObjectURL(c),format:l}),i()}),t.addEventListener("cancel",o=>{a(new f("User cancelled photos app")),i()})),t.accept="image/*",t.capture=!0,e.source===m.Photos||e.source===m.Prompt?t.removeAttribute("capture"):e.direction===d.Front?t.capture="user":e.direction===d.Rear&&(t.capture="environment"),t.click()}multipleFileInputExperience(e,r){let a=document.querySelector("#_capacitor-camera-input-multiple"),t=()=>{var i;(i=a.parentNode)===null||i===void 0||i.removeChild(a)};a||(a=document.createElement("input"),a.id="_capacitor-camera-input-multiple",a.type="file",a.hidden=!0,a.multiple=!0,document.body.appendChild(a),a.addEventListener("change",i=>{let o=[];for(let c=0;c<a.files.length;c++){let l=a.files[c],p="jpeg";l.type==="image/png"?p="png":l.type==="image/gif"&&(p="gif"),o.push({webPath:URL.createObjectURL(l),format:p})}e({photos:o}),t()}),a.addEventListener("cancel",i=>{r(new f("User cancelled photos app")),t()})),a.accept="image/*",a.click()}_getCameraPhoto(e,r){return new Promise((a,t)=>{let i=new FileReader,o=e.type.split("/")[1];r.resultType==="uri"?a({webPath:URL.createObjectURL(e),format:o,saved:!1}):(i.readAsDataURL(e),i.onloadend=()=>{let c=i.result;r.resultType==="dataUrl"?a({dataUrl:c,format:o,saved:!1}):a({base64String:c.split(",")[1],format:o,saved:!1})},i.onerror=c=>{t(c)})})}checkPermissions(){return s(this,null,function*(){if(typeof navigator>"u"||!navigator.permissions)throw this.unavailable("Permissions API not available in this browser");try{return{camera:(yield window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw this.unavailable("Camera permissions are not available in this browser")}})}requestPermissions(){return s(this,null,function*(){throw this.unimplemented("Not implemented on web.")})}pickLimitedLibraryPhotos(){return s(this,null,function*(){throw this.unavailable("Not implemented on web.")})}getLimitedLibraryPhotos(){return s(this,null,function*(){throw this.unavailable("Not implemented on web.")})}},R=new u;var v=P("Camera",{web:()=>new u});var j=(()=>{let e=class e{constructor(){this.platform=b(g),this.photos=w([])}addNewToGallery(){return s(this,null,function*(){let a=yield v.getPhoto({resultType:h.Base64,source:m.Camera,quality:80});this.photos.set([a.base64String])})}clearPhotos(){this.photos.set([])}};e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();export{j as a};
